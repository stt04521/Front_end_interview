### js 操作符

#### 检测类型操作符

#### 01 typeof 操作符
多用于基本类型检测，string number boolean object function undefined

#### 02 instanceof 
用于检测对象类型

#### 算数操作符

#### 1.1递增 递减
分为前置 后置
- 前置，先加减1，再对变量操作
- 后置，先对变量操作，再加减1
先转换为数值，在进行计算
- 对象，先调用对象的 valueOf 方法，获得可操作的值，z转换为数组，如果结果为NaN,在调用对象的toString 方法，再转化为数值变量计算

> https://www.cnblogs.com/weiqinl/p/8380060.html

#### 位操作符

ECMAScript中所有数据都是以IEEE-754 64位格式存储，但是位运算符不直接操作64位的值，而是以32位带符号的整数进行运算，并且返回值也是一个32位带符号的整数

这种位数转换使得在对特殊的NaN和Infinity值应用位操作时，这两个值都会被当成0来处理

如果对非数值应用位操作符，会先使用Number()将该值转换成数值再应用位操作，得到的结果是一个数值

有符号整数使用32位中的前31位表示整数数值，用第32位表示整数符号，0表示正数，1表示负数。

负数同样以二进制存储，但使用的格式是二进制补码。计算一个数值的二进制补码，需要经过下列3个步骤：

【1】求这个数值绝对值的二进制码

【2】求二进制反码，即将0替换成1，将1替换成0

【3】得到的二进制反码加1

按位非(NOT) ~

返回数值的反码,其本质是操作数的负值减1

```
var num1 = 25;
var num2 = ~num1;
console.log(num2);//-26
```
对一个整数两次按位非，可以得到它本身；对一个小数两次按位非，可以得到取整效果

```
console.log(~~3);//3
console.log(~~3.1);//3
console.log(~~3.9);//3
```

按位与(AND) &

按位与操作符由一个和号符号(&)表示 从本质上讲，按位与操作就是将两个数值的每一位对齐（速记：二一为一，其余为0），只有相当位置，同时为1时，结果才为1

常用作判断奇数偶数
```
console.log(12 & 1);// 0
console.log(11 & 1);//1
```

按位或(OR) |

按位或操作符由一个竖线符号(|)表示，同样也有两个操作数（速记：二0为0，其余为1）

一个整数与0按位或运算可以得到它本身，一个小数与0按位或运算可以得到取整效果
```
console.log(3.1 | 0);//3
console.log(3.9 | 0);//3
```

按位异或(XOR) ^

按位异或操作符由一个插入符号(^)表示，也有两个操作数。（速记：相同为0，其余为1）

“异或运算”有一个特殊运用，连续对两个数a和b进行三次异或运算，aˆ=b, bˆ=a, aˆ=b，可以互换它们的值。这意味着，使用“异或运算”可以在不引入临时变量的前提下，互换两个变量的值

```
var a=10,b=9;
a ^= b, b ^= a, a ^= b;
console.log(a,b);//9,10
```
一个整数与0按位异或可以保持其自身，一个小数与0按位异或可以取整
```
console.log(3.1 ^ 0);//3
console.log(3.9 ^ 0);//3
```

左移 <<

左移操作符由两个小于号(<<)表示，这个操作符会将数值的所有位向左移动指定的位数

左移0位可以实现取整效果
```
console.log(3.1 << 0);//3
console.log(3.9 << 0);//3`
```

有符号右移 >>

有符号的右移操作符由两个大于号(>>)表示，这个操作符会将数值向右移动，但保留符号位(即正负号标记)

右移可以模拟2的整除运算

```
console.log(5>>1);//2
console.log(15>>1);//7
```

无符号右移>>>
无符号右移操作符会把负数的二进制码当成正数的二进制码。而且，由于负数以其绝对值的二进制补码形式表示，因此就会导致无符号右移后的结果非常之大

要确定-64的二进制表示，首先必须得到64的二进制表示，如下所示：

```
0000 0000 0000 0000 0000 0000 0100 0000
```
接下来，计算二进制反码，如下所示
```
1111 1111 1111 1111 1111 1111 1011 1111
```
最后，在二进制反码上加 1，如下所示
```
1111 1111 1111 1111 1111 1111 1011 1111
```
向右移动5位后，如下所示：
```
0000 0111 1111 1111 1111 1111 1111 1110
console.log(0b00000111111111111111111111111110);//134217726
```
> 总结

~ 取本身反码 

& 对位比较 双一为一

| 对位比较 有一则一

^ 对位比较 仅1个1为1

<< >> 左移右移 不影响符号

三个右移影响符号 >>> 

> 实际中 应用

【1】 利用左移实现乘法运算
```
console.log(2 << 1);//4
console.log(3 << 1);//6
console.log(4 << 1);//8
```
【2】除法运算
利用有符号右移(>>)来模拟2的整除运算
```
console.log(2 >> 1);//1
console.log(5 >> 1);//2
console.log(8 >> 1);//4
console.log(9 >> 1);//4
```

【3】值互换
```
var a=10,b=9;
a ^= b, b ^= a, a ^= b;
console.log(a,b);//9,10
```
【4】小数取整
利用取两次按位非、与0按位或、与0按位异或、左移0位、右移0位都可以实现小数取整效果
```
console.log(~~3.1);//3
console.log(3.1|0);//3
console.log(3.1^0);//3
console.log(3.1<<0);//3
console.log(3.1>>0);//3
```
[【5】开关](https://www.runoob.com/w3cnote/32-float-storage.html)

【6】判断奇偶
```
奇数 & 1 = 1
偶数 & 1 = 0
```

>补充知识 32位 64位 浮点数

参考地址:[32 位 float 型的二进制存储](https://www.runoob.com/w3cnote/32-float-storage.html)

参考地址:[IEEE-754 64位双精度浮点数存储详解](https://www.jianshu.com/p/3e08b3efc5df)

参考地址:[将10进制数转换为IEEE754标准的32位浮点数的二进制格式](https://blog.csdn.net/s1050712899/article/details/105209451)

32位存储，指数位 8位 符号位1位 24位尾数 单精度浮点数的有效位数是7位。

64位存储，指数位 11位 符号位1位 52位尾数 双精度浮点数的有效位数是16位。

为什么采用移码？

如果阶码（指数）也用补码来表示，就会使得一个浮点数中出现两个符号位：浮点数自身的和浮点数指数部分的。这样的结果是，在比较两个浮点数大小时，无法像比较整数时一样使用简单的无逻辑的二进制比较。

为什么IEEE标准中，8位阶码的偏置为127？

8位移码的取值范围为0~255（00000000~11111111），但在浮点数的阶码中，00000000与11111111被保留用作特殊情况，所以阶码可用范围只有1~254，总共有254个值。127与128是254个值的中位数，127与128作为偏置均合理。若以127为偏置，则阶码的取值范围为-127~126；若以128为偏置，则阶码的取值范围为-126~127。为了平衡浮点数精度与取值范围（精度越大则取值范围越小，精度越小则取值范围越大），IEEE标准中，规定8位阶码的偏置为127，使得浮点数的取值范围更大。


#### 布尔操作符

&&

- 第一个操作数 不是布尔值，则使用 Boolean 进行转换
- 如果返回 true，返回第二个操作数
- 如果返回 false，返回第一个操作数

||

-  第一个操作数 不是布尔值，则使用 Boolean 进行转换
- 如果返回 true，返回第一个操作数
- 如果返回 false，返回第二个操作数

 加法

- 操作数是字符串
 - 都是字符串，进行凭借
 - 只有一个是字符串，转换为字符串，在进行拼接 
 - 如果是对象，数值，布尔值，调用 toString()取得相应的字符串值
 - 如果是 undefined null，String()函数取得字符串值

 减法
 - 操作数是字符串、布尔值、null、undefined，先在后台调用 Number() 函数转换为数值，在按上面规则执行
 - 操作数是对象，调用对象的 valueOf() 方法取得对象的数值，如果结果是 NaN，则减法的结果是 NaN。如果没有 valueOf() 方法，则调用其 toString() 方法将其得到的字符串转换为数值

 关系操作符

> 关系操作符有：< > <= >=

规则：
- 否是数值，进行数值比较
- 都是字串比较字符串对应的字符编码
- 一个是对象，则将另一个也转换成，对象进行比较
- 如果是对象，先调用valueOf 取得对象的数值，如果没有就调用toString方法
- 如果操作数存在 NaN undefined null,则结果都是 返回false

#### 相等操作符

规则：
- 一个是对象一个是字符串，把对象转为字符串之后，再进行比较
- 都是对象，则比较是不是同一对象，如果指向同一对象，则相等返回 false
- 其他都是转为数值 再进行比较

#### 逗号操作符
```
var num = (5, 1, 4, 0); //=> num: 0
```

#### 逻辑运算符

优先级从高到底：
- 逻辑非 ！
- 逻辑与 &&
- 逻辑或 || 

```
0 || 1 && 2 || 0 || 3 && 2 || 1; //=> 2
```
